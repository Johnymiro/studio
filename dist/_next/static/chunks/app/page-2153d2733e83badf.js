(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2383:()=>{},3686:()=>{},7909:(e,t,a)=>{Promise.resolve().then(a.bind(a,7971))},7971:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ed});var r=a(5155),s=a(2115),l=a(3925),n=a(9708),i=a(2085),o=a(2596),d=a(9688);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,d.QP)((0,o.$)(t))}let f=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:i=!1,...o}=e,d=i?n.DX:"button";return(0,r.jsx)(d,{className:c(f({variant:s,size:l,className:a})),ref:t,...o})});u.displayName="Button";let m=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});m.displayName="Input";let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:c("w-full caption-bottom text-sm",a),...s})})});x.displayName="Table";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("thead",{ref:t,className:c("[&_tr]:border-b",a),...s})});p.displayName="TableHeader";let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tbody",{ref:t,className:c("[&_tr:last-child]:border-0",a),...s})});h.displayName="TableBody",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tfoot",{ref:t,className:c("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})}).displayName="TableFooter";let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tr",{ref:t,className:c("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});b.displayName="TableRow";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("th",{ref:t,className:c("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...s})});g.displayName="TableHead";let y=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("td",{ref:t,className:c("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});y.displayName="TableCell";let v=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("caption",{ref:t,className:c("mt-4 text-sm text-muted-foreground",a),...s})});v.displayName="TableCaption";var j=a(2912),N=a(5318);let w=j.bL,k=j.l9,A=j.ZL;j.bm;let C=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(j.hJ,{ref:t,className:c("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});C.displayName=j.hJ.displayName;let R=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(A,{children:[(0,r.jsx)(C,{}),(0,r.jsxs)(j.UC,{ref:t,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[s,(0,r.jsxs)(j.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(N.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});R.displayName=j.UC.displayName;let _=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:c("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};_.displayName="DialogHeader";let S=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(j.hE,{ref:t,className:c("text-lg font-semibold leading-none tracking-tight",a),...s})});S.displayName=j.hE.displayName;let z=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(j.VY,{ref:t,className:c("text-sm text-muted-foreground",a),...s})});z.displayName=j.VY.displayName;var E=a(7484),L=a(518);let T=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(E.bL,{ref:t,className:c("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(E.C1,{className:c("flex items-center justify-center text-current"),children:(0,r.jsx)(L.A,{className:"h-4 w-4"})})})});T.displayName=E.bL.displayName;var F=a(968);let P=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),B=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(F.b,{ref:t,className:c(P(),a),...s})});B.displayName=F.b.displayName;var O=a(9968),D=a(1887),H=a(154),U=a(511),V=a(5599),J=a(8027),Y=a(8763),q=a(1840),I=a(2448),M=a(7270),Q=a(8186),W=a(6936),X=a(172),Z=a(9637),$=a(4063),G=a(8046),K=a(4301),ee=a(5074),et=a(7057),ea=a(8271),er=a(7390),es=a(5731),el=a(4956),en=a(1721),ei=a(8018);let eo={arrowRight:O.A,check:L.A,chevronDown:D.A,circle:H.A,workflow:U.A,close:N.A,copy:V.A,dark:J.A,edit:Y.A,externalLink:q.A,file:I.A,help:M.A,home:Q.A,light:W.A,loader:X.A,mail:Z.A,messageSquare:$.A,plus:G.A,plusCircle:K.A,search:ee.A,server:et.A,settings:ea.A,share:er.A,shield:es.A,spinner:X.A,trash:el.A,user:en.A,print:ei.A};function ed(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(null),[f,j]=(0,s.useState)([]),N=(0,s.useCallback)(e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!r)return;let s=new FileReader;s.onload=e=>{var a;let r=null===(a=e.target)||void 0===a?void 0:a.result;if("string"==typeof r){let e=l.LF(r,{type:"binary"}),a=e.SheetNames[0],s=e.Sheets[a],i=l.Wp.sheet_to_json(s);i.length>0&&(t(i),n(Object.keys(i[0])))}},s.readAsBinaryString(r)},[]),A=(0,s.useMemo)(()=>{let t=i.toLowerCase();return e.filter(e=>a.some(a=>String(e[a]).toLowerCase().includes(t)))},[e,i,a]),C=e=>{c(e),j(Object.keys(e))},E=e=>{j(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},L=()=>{if(!d)return;let e=f.map(e=>'<div style="margin-bottom: 8px;"><strong>'.concat(e,":</strong> ").concat(d[e],"</div>")).join(""),t=window.open("","_blank");t&&(t.document.write("\n        <html>\n        <head>\n          <title>Billing Printout</title>\n          <style>\n            body { font-family: sans-serif; }\n          </style>\n        </head>\n        <body>\n          ".concat(e,"\n        </body>\n        </html>\n      ")),t.document.close(),t.focus(),t.print(),t.close())};return(0,r.jsxs)("div",{className:"container mx-auto py-10",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold mb-5 text-center text-primary",children:"ExcelBill"}),(0,r.jsxs)("div",{className:"mb-5 flex items-center space-x-4",children:[(0,r.jsx)(m,{type:"file",accept:".xls, .xlsx",onChange:N,className:"flex-grow"}),(0,r.jsx)(m,{type:"search",placeholder:"Search table...",onChange:e=>o(e.target.value),className:"max-w-xs"})]}),e.length>0?(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg border shadow-md",children:(0,r.jsxs)(x,{children:[(0,r.jsx)(v,{children:"Parsed Excel data displayed in a filterable table."}),(0,r.jsx)(p,{children:(0,r.jsxs)(b,{children:[a.map(e=>(0,r.jsx)(g,{children:e},e)),(0,r.jsx)(g,{className:"w-[50px]",children:"Action"})]})}),(0,r.jsx)(h,{children:A.map((e,t)=>(0,r.jsxs)(b,{children:[a.map(t=>(0,r.jsx)(y,{children:e[t]},t)),(0,r.jsx)(y,{children:(0,r.jsxs)(w,{children:[(0,r.jsx)(k,{asChild:!0,children:(0,r.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>C(e),className:"text-green-500 hover:bg-green-100",children:(0,r.jsx)(eo.print,{className:"h-4 w-4"})})}),(0,r.jsxs)(R,{children:[(0,r.jsxs)(_,{children:[(0,r.jsx)(S,{children:"Print Selection"}),(0,r.jsx)(z,{children:"Select which fields to include in the billing printout."})]}),(0,r.jsx)("div",{className:"grid gap-4 py-4",children:d&&Object.keys(d).map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(T,{id:e,checked:f.includes(e),onCheckedChange:()=>E(e)}),(0,r.jsx)(B,{htmlFor:e,children:e})]},e))}),(0,r.jsx)(u,{type:"button",onClick:L,children:"Print"})]})]})})]},t))})]})}):(0,r.jsx)("div",{className:"text-center text-muted-foreground",children:"Upload an Excel file to display data."})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,319,441,684,358],()=>t(7909)),_N_E=e.O()}]);